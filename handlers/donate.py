# handlers/donate.py
from telegram import Update
from telegram.ext import ContextTypes
from utils.markdown_helpers import escape_markdown_v2 # –ï—Å–ª–∏ –±—É–¥–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å MarkdownV2 –≤ —Ç–µ–∫—Å—Ç–µ

async def donate_command(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è—Ö."""
    # –í–µ—Å—å —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è—Ö
    raw_donation_message = (
        "‚ú® *–í–∞—à–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ ‚Äì —ç—Ç–æ —á–∏—Å—Ç—ã–π –≤–æ–∑–¥—É—Ö –ë–∏—à–∫–µ–∫–∞!* ‚ú®\n\n"
        "–ü—Ä–∏–≤–µ—Ç! –ú—ã, –∫–æ–º–∞–Ω–¥–∞ \"–ë–∏—à–∫–µ–∫ –≠–∫–æ–ú–æ–Ω–∏—Ç–æ—Ä\", –∏—Å–∫—Ä–µ–Ω–Ω–µ –±–ª–∞–≥–æ–¥–∞—Ä–Ω—ã –∑–∞ —Ç–æ, —á—Ç–æ –≤—ã —Å –Ω–∞–º–∏. "
        "–ù–∞—à –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç 24/7, —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π –∂–∏—Ç–µ–ª—å –ë–∏—à–∫–µ–∫–∞ –∏–º–µ–ª –¥–æ—Å—Ç—É–ø –∫ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ "
        "–æ –∫–∞—á–µ—Å—Ç–≤–µ –≤–æ–∑–¥—É—Ö–∞ –∏ –º–æ–≥ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è —Å–≤–æ–µ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è.\n\n"
        "–ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ —Ç—Ä–µ–±—É–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç: –æ–ø–ª–∞—Ç–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤, "
        "–¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤—ã—Ö, –ø–æ–ª–µ–∑–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π. "
        "–ú—ã —Å—Ç—Ä–µ–º–∏–º—Å—è –Ω–µ –ø—Ä–æ—Å—Ç–æ –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ –∏ –ø–æ–º–æ–≥–∞—Ç—å –≤–∞–º –¥—ã—à–∞—Ç—å —Å–≤–æ–±–æ–¥–Ω–µ–µ.\n\n"
        "–ï—Å–ª–∏ –≤—ã —Ü–µ–Ω–∏—Ç–µ –Ω–∞—à –≤–∫–ª–∞–¥ –∏ —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –±–æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–ª —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è "
        "–∏ —Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è –µ—â–µ –ª—É—á—à–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–º–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞–º–∏, "
        "—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º –ø–æ–∫—Ä—ã—Ç–∏–µ–º —Ä–∞–π–æ–Ω–æ–≤ –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–µ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤–æ–¥—ã), "
        "–≤–∞—à–∞ –ø–æ–º–æ—â—å –±—É–¥–µ—Ç –±–µ—Å—Ü–µ–Ω–Ω–∞! –î–∞–∂–µ –Ω–µ–±–æ–ª—å—à–æ–π –≤–∫–ª–∞–¥ –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞–º –¥–≤–∏–≥–∞—Ç—å—Å—è –≤–ø–µ—Ä–µ–¥ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç.\n\n"
        "*–ö–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–º–æ—á—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:*\n"
        "üí≥ *MBank Online*: `[0779715638]`\n\n" # –û—Å—Ç–∞–≤–∏–ª –≤–∞—à –Ω–æ–º–µ—Ä, –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π
        "–≠—Ç–æ—Ç –±–æ—Ç –±—ã–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω [@abaikb]`\n\n" # –û—Å—Ç–∞–≤–∏–ª –≤–∞—à –Ω–æ–º–µ—Ä, –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π
        "–ö–∞–∂–¥—ã–π –≤–∞—à —Å–æ–º ‚Äî —ç—Ç–æ –≥–ª–æ—Ç–æ–∫ —Å–≤–µ–∂–µ–≥–æ –≤–æ–∑–¥—É—Ö–∞ –¥–ª—è –ë–∏—à–∫–µ–∫–∞. "
        "–û–≥—Ä–æ–º–Ω–æ–µ —Å–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à—É –ø–æ–¥–¥–µ—Ä–∂–∫—É, –¥–æ–≤–µ—Ä–∏–µ –∏ –∑–∞–±–æ—Ç—É –æ –Ω–∞—à–µ–º –æ–±—â–µ–º –±—É–¥—É—â–µ–º!\n"
        "–° –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é,\n"
        "–ö–æ–º–∞–Ω–¥–∞ \"–ë–∏—à–∫–µ–∫ –≠–∫–æ–ú–æ–Ω–∏—Ç–æ—Ä\""
    )

    # –ü—Ä–∏–º–µ–Ω—è–µ–º escape_markdown_v2 –∫–æ –≤—Å–µ–π —Å—Ç—Ä–æ–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    donation_message = escape_markdown_v2(raw_donation_message)

    # –í—ã–±–∏—Ä–∞–µ–º, –∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ: –≤ update.message –∏–ª–∏ update.callback_query.message
    message_to_send = update.message
    if not message_to_send and update.callback_query:
        message_to_send = update.callback_query.message

    if message_to_send:
        await message_to_send.reply_markdown_v2(donation_message)
    else:
        # Fallback, –µ—Å–ª–∏ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ –Ω–µ—Ç –Ω–∏ update.message, –Ω–∏ update.callback_query.message
        await context.bot.send_message(
            chat_id=update.effective_chat.id,
            text=escape_markdown_v2("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –¥–æ–Ω–∞—Ç–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑."),
            parse_mode='MarkdownV2'
        )
